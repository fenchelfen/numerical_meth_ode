<!DOCTYPE HTML>
<html>
 <head>
  <meta charset="utf-8"/>
  <title>
   numerical_meth_ode
  </title>
  <link href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/github.min.css" rel="stylesheet"/>
  <style type="text/css">
   body,table tr{background-color:#fff}table tr td,table tr th{border:1px solid #ccc;text-align:left;padding:6px 13px;margin:0}pre code,table,table tr{padding:0}hr,pre code{background:0 0}body{font:16px Helvetica,Arial,sans-serif;line-height:1.4;color:#333;word-wrap:break-word;padding:10px 15px}strong,table tr th{font-weight:700}h1{font-size:2em;margin:.67em 0;text-align:center}h2{font-size:1.75em}h3{font-size:1.5em}h4{font-size:1.25em}h1,h2,h3,h4,h5,h6{font-weight:700;position:relative;margin-top:15px;margin-bottom:15px;line-height:1.1}h1,h2{border-bottom:1px solid #eee}hr{height:0;margin:15px 0;overflow:hidden;border:0;border-bottom:1px solid #ddd}a{color:#4183C4}a.absent{color:#c00}ol,ul{padding-left:15px;margin-left:5px}ol{list-style-type:lower-roman}table tr{border-top:1px solid #ccc;margin:0}table tr:nth-child(2n){background-color:#aaa}table tr td :first-child,table tr th :first-child{margin-top:0}table tr td:last-child,table tr th :last-child{margin-bottom:0}img{max-width:100%}blockquote{padding:0 15px;border-left:4px solid #ccc}code,tt{margin:0 2px;padding:0 5px;white-space:nowrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px}pre code{margin:0;white-space:pre;border:none}.highlight pre,pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}
  </style>
 </head>
 <body>
  <h1 id="numerical_meth_ode">
   numerical_meth_ode
  </h1>
  <h3 id="introduction">
   Introduction
  </h3>
  <p>
   This is a
   <code>
    Python3/Tkinter
   </code>
   application for plotting approximations of a differential equation solution using the following methods:
  </p>
  <ul>
   <li>
    Euler
   </li>
   <li>
    Heun (Improved Euler)
   </li>
   <li>
    Runge-Kutta
   </li>
  </ul>
  <p>
   Here is the initial value problem (IVP)
  </p>
  <p>
   <mathjax>
    $$\begin{cases}
    y^{\prime} &amp;=&amp; 3xe^{x} - y\ (1-\frac{1}{x})  \\ 
    y\ (1) &amp;=&amp; 0
\end{cases}$$
   </mathjax>
  </p>
  <p>
   This document shows how to get the exact solution of the IVP and then demostrates all of the methods listed above.
  </p>
  <h4 id="contents">
   Contents
  </h4>
  <ol>
   <li>
    Exact solution
   </li>
   <li>
    Methods overview
   </li>
   <li>
    Application overview
   </li>
  </ol>
  <h3 id="1-exact-solution">
   1. Exact solution
  </h3>
  <p>
   Linear, nonhomogeneous ode of the first degree
   <br/>
   <mathjax>
    $$y^{\prime} = 3xe^{x} - y\ (1-\frac{1}{x})$$
   </mathjax>
   <br/>
   Lets find the general solution first.
  </p>
  <p>
   Solve the complementary equation
   <br/>
   <mathjax>
    $$y^{\prime} + y\ (1 - \frac{1}{x}) = 0$$
   </mathjax>
   <br/>
   Turn it into separable form and apply integration
   <br/>
   <mathjax>
    $$\begin{align} &amp;\int{\frac{dy}{y}} = \int{(\frac{1}{x}-1)dx} \\  \\&amp;\ln{|y|}  = \ln{|x|} - x + C  \\ \\ &amp;y = xke^{-x}\end{align}$$
   </mathjax>
   <br/>
   Assume that k equals = 1. To find the general solution, apply substitution
   <br/>
   <mathjax>
    $$\begin{cases}
    y &amp;=&amp; uy_1 \\
    y^{\prime} &amp;=&amp; u'y_1 + uy_1
\end{cases}$$
   </mathjax>
   <br/>
   where y
   <sub>
    1
   </sub>
   is the solution of the complementary.
  </p>
  <p>
   Substituting y’ and y into the intial equation, we get
   <br/>
   <mathjax>
    $$\begin{align} &amp;u' = \frac{3xe^{x}}{y_1}  \\ \\ &amp;u = \int{\frac{3xe^x dx}{xe^{-x}}}\end{align}$$
   </mathjax>
  </p>
  <p>
   Substituting y back and integrating gives the general solution
   <br/>
   <mathjax>
    $$\begin{align} &amp;y = xe^{-x} \int{\frac{3xe^{x} dx}{xe^{-x}}} \\ \\
&amp;y = x\frac{3xe^{x}}{2} + Ce^{-x}\end{align}$$
   </mathjax>
  </p>
  <p>
   Using the initial conditions given, we derive the constant C
   <br/>
   <mathjax>
    $$C = \frac{-3e^{2}}{2}$$
   </mathjax>
   <br/>
   Thus, we have the IVP solution
   <br/>
   <mathjax>
    $$y = \frac{3xe^{-x}}{2}(e^{2x} - e^2)$$
   </mathjax>
  </p>
  <hr/>
  <h3 id="2-methods-overview">
   2. Methods overview
  </h3>
  <p>
   All approximations below are computed with the following parameters:
  </p>
  <ul>
   <li>
    x0 = 1
   </li>
   <li>
    y0 = 0
   </li>
   <li>
    X = 5
   </li>
   <li>
    h = 0.1
   </li>
   <li>
    n0 = 3
   </li>
   <li>
    N = 9
   </li>
  </ul>
  <h4 id="comparison-with-the-exact-solution">
   Comparison with the exact solution
  </h4>
  <p>
   The first figure shows the plots on a relatively large scale and the step is tiny, so it is not easy to see how approximations differ from the exact solution.
  </p>
  <p>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/Approximations.png"/>
  </p>
  <p>
   Here we can clearly observe that Euler approximation gradually goes much lower than the exact. This fact has a good explanation, we are trying to approximate a function which is convex.
  </p>
  <p>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/Approximations_zoom.png"/>
  </p>
  <h4 id="local-errors">
   Local errors
  </h4>
  <p>
   Local error continues upwards as x grows, we were lucky enough to get a predictable function.
  </p>
  <p>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/Local.png"/>
  </p>
  <p>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/Local_zoom.png"/>
  </p>
  <h4 id="total-errors">
   Total errors
  </h4>
  <p>
   Total error continues downwards as the number of grid cells increases.
  </p>
  <h2 id="_1">
   <img alt="" src="/strg/numerical_meth_ode/Pictures/Total.png"/>
  </h2>
  <h3 id="3-application-overview">
   3. Application overview
  </h3>
  <p>
   Tkinter is a stock framework for Python which is relatively simple and reliable, this is why I have chosen it. Despite the fact that Tkinter does not have a particulary great outlook, it was fixed by means of
   <code>
    ttk
   </code>
   – a themed widget set.
  </p>
  <p>
   Since the application is fully educational in nature, the standard python3 functionality was used (e.g.
   <code>
    pow
   </code>
   and
   <code>
    exp
   </code>
   ).
  </p>
  <p>
   Each method (Euler, Heun and Runge-Kutta) is implemented as a separate module. Though this is not the best design decision, those modules were implemented long before the assignment was given. Thus, they were heavilly tested and could be easily integrated with the rest.
  </p>
  <p>
   Plotting is made by an autonomous class
   <code>
    Plotter
   </code>
   which inherits from tkinter’s backend
   <code>
    Canvas
   </code>
   . This is made for the purpose of modularity, now plotter can be embedded in almost any kind of tkinter interface.
  </p>
  <p>
   Application was structured following the rules listed on
   <a href="https://stackoverflow.com/a/17470842/9308909">
   </a>
   <a href="https://stackoverflow.com/a/17470842/9308909">
    stackoverflow.com
   </a>
  </p>
  <p>
   All graphics is handled by a custom class
   <code>
    MainApplication
   </code>
   which inherits from
   <code>
    ttk.Frame
   </code>
   .
  </p>
  <p>
   Inside the window there are two instances of
   <code>
    ttk.Frame
   </code>
   input and plotting. First frame containts
   <code>
    ttk.Notebook
   </code>
   with several objects of
   <code>
    tkk.Frame
   </code>
   holding our canvas for drawing.
  </p>
  <h4 id="interesting-snippets">
   Interesting snippets
  </h4>
  <p>
   Tkinter interface initialization.
  </p>
  <pre><code class="Python">def __init__(self, master, *args, **kwargs):

    super().__init__(root, padding='5 5 5 5')
    self.grid(column=0, row=0, sticky='nsew')

    frame = ttk.Frame(self, borderwidth=8)
    frame.grid(column=0, row=0, sticky='nsew')
    frame.rowconfigure(0, weight=1)

    notes = ttk.Notebook(frame)
    notes.grid(column=0, row=0, sticky='nsew')
    notes.rowconfigure(0, weight=1)

    page1 = ttk.Frame(notes)
    page2 = ttk.Frame(notes)
    page3 = ttk.Frame(notes)

    notes.add(page1, text='Approximations')
    notes.add(page2, text='Local')
    notes.add(page3, text='Total')

    plot1 = plotter.Plotter(page1)
    plot2 = plotter.Plotter(page2)
    plot3 = plotter.Plotter(page3)

    &lt;...&gt;

</code></pre>
  <p>
   A function for updating plots when the input is changed.
  </p>
  <pre><code class="Python">def update_canvas(self, x0, y0, h, X, n0, N, flag):

     self.x0 = x0
     self.y0 = y0
     self.h  = h
     self.X  = X
     self.N  = N
     self.n0 = n0

     self.axes.clear()

     plots = {
         0: self.plot_approx,
         1: self.plot_local,
         2: self.plot_total
     }

     plots.get(flag, 'No such plot')()

     self.axes.legend(fancybox=False)
     self.draw_idle()

</code></pre>
  <pre><code class="Python">def heun_compute(x0, y0, h, func, X): 

    x, y = x0, y0
    pairs = list()
    while (x &lt;= X): 
        pairs.append((x,y));
        y = heun_new(x, y, h, func)
        x += h
    return pairs

</code></pre>
  <h4 id="uml-and-packages">
   UML and packages
  </h4>
  <p>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/Plotter__inherit__graph.png"/>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/MainApplication__inherit__graph.png"/>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/packages_Pyreverse.png"/>
  </p>
  <p>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/inherit_graph_2.png"/>
   <br/>
   <img alt="" src="/strg/numerical_meth_ode/Pictures/inherit_graph_1.png"/>
  </p>
  <h4 id="author">
   Author
  </h4>
  <p>
   Mikhail Lyamets BS17-07
  </p>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/highlight.min.js">
  </script>
  <script>
   hljs.initHighlightingOnLoad();
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
  </script>
  <script type="text/javascript">
   MathJax.Hub.Config({"showProcessingMessages" : false,"messageStyle" : "none","tex2jax": { inlineMath: [ [ "$", "$" ] ] }});
  </script>
 </body>
</html>
